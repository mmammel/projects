<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

    <script type="text/javascript">
      var gridSize=20;
      var voffset = 0;
      var hoffset = 0;
      var intervalRef = null;

      function modVar( plusminus, varname ) {
        modVarInner( plusminus, varname );
        intervalRef = setInterval( function() {
          modVarInner( plusminus, varname );
        }, 200);
      }

      function modVarInner(plusminus, varname) {
        var increment = 1;
        if( plusminus == '-' ) increment = -1;

        if( varname == "grid" ) {
          gridSize += increment;
        } else if( varname == "hoff" ) {
          hoffset += increment;
          if( hoffset > gridSize ) hoffset = 0;
          if( hoffset < 0 ) hoffset = gridSize;
        } else if( varname == "voff" ) {
          voffset += increment;
          if( voffset > gridSize ) voffset = 0;
          if( voffset < 0 ) voffset = gridSize;
        }
        doImageLoad();
      }

      function doImageLoad() {
        var imgURL = $("#imgURL").val();
        var imgTag = $('<img id="hiddenImage" src="' + imgURL + '"></img>');
        $("#imageHolder").empty();
        $("#imageHolder").append(imgTag);
        var cnv = document.getElementById("mycanvas");
        var img = document.getElementById("hiddenImage");
        cnv.width = img.clientWidth;
        cnv.height = img.clientHeight;
        var context = cnv.getContext("2d");
        context.drawImage(img,0,0); 
        context.stroke();

        var vidx = hoffset;
        var hidx = voffset;

        context.beginPath();
        while( vidx <= cnv.width ) {
          context.moveTo(vidx,0);
          context.lineTo(vidx,cnv.height);
          context.stroke();
          vidx += gridSize;
        }
        while( hidx <= cnv.height ) {
          context.moveTo(0,hidx);
          context.lineTo(cnv.width,hidx);
          context.stroke();
          hidx += gridSize;
        }
      }
    </script>
  </head>
  <body>
    <table>
      <tr>
        <td>Image URL:</td><td colspan="2"><input id="imgURL" name="imgURL" type="text" size="50" value=""></input></td>
      </tr>
      <tr>
        <td colspan="3"><input onclick="javascript:doImageLoad();" type="button" value="Submit"></input></td>
      </tr>
      <tr>
        <td>Grid Size:</td><td><input onmouseup="javascript:clearInterval(intervalRef);" onmousedown="javascript:modVar('-','grid');" id="gridsizeminus" name="gridsizeminus" type="button" value="-"></input></td><td><input onmouseup="javascript:clearInterval(intervalRef);" onmousedown="javascript:modVar('+','grid');" id="gridsizeplus" name="gridsizeplus" type="button" value="+"></input></td>
      </tr>
      <tr>
        <td>H-Offset:</td><td><input onmouseup="javascript:clearInterval(intervalRef);" onmousedown="javascript:modVar('-','hoff');" id="hoffminus" name="hoffminus" type="button" value="-"></input></td><td><input onmouseup="javascript:clearInterval(intervalRef);" onmousedown="javascript:modVar('+','hoff');" id="hoffplus" name="hoffplus" type="button" value="+"></input></td>
      </tr>
      <tr>
        <td>V-Offset:</td><td><input onmouseup="javascript:clearInterval(intervalRef);" onmousedown="javascript:modVar('-','voff');" id="voffminus" name="voffminus" type="button" value="-"></input></td><td><input onmouseup="javascript:clearInterval(intervalRef);" onmousedown="javascript:modVar('+','voff');" id="voffplus" name="voffplus" type="button" value="+"></input></td>
      </tr>

    </table>
    <div id="canvasDiv">
      <canvas id="mycanvas"></canvas>
    </div>
    <div id="imageHolder" style="visibility:hidden;">
    </div>
  </body>
</html>
